<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historical Analysis - Bitcoin Power Law Observatory</title>
  <meta name="description" content="Explore Bitcoin's historical price data through log-log charts and mean reversion analysis.">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="header">
    <div class="container">
      <a href="../index.html" class="logo">
        <span class="logo-icon">&#x20BF;</span>
        Power Law Observatory
      </a>
      <nav class="nav" aria-label="Main navigation">
        <a href="../index.html">Dashboard</a>
        <a href="history.html" class="active">History</a>
        <a href="future.html">Future</a>
        <a href="dca.html">DCA</a>
        <a href="retirement.html">Retirement</a>
        <a href="about.html">About</a>
      </nav>
      <div class="lang-toggle">
        <a href="history.html" class="lang-link active">EN</a>
        <span class="lang-sep">|</span>
        <a href="../nl/pages/history.html" class="lang-link">NL</a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero">
        <h1>Historical Analysis</h1>
        <p>Bitcoin's price history plotted on a log-log scale reveals a remarkably consistent power law relationship. Deviations from the trend are dramatic but statistically ordinary.</p>
      </section>

      <!-- Axis scale toggles + band checkboxes -->
      <div class="scale-toggles">
        <div class="scale-group">
          <span class="scale-group-label">Time</span>
          <div class="pill-group" role="group" aria-label="Time axis scale">
            <button class="pill-btn" data-axis="x" data-scale="linear">Linear</button>
            <button class="pill-btn active" data-axis="x" data-scale="logarithmic">Log</button>
          </div>
        </div>

        <div class="scale-group">
          <span class="scale-group-label">Price</span>
          <div class="pill-group" role="group" aria-label="Price axis scale">
            <button class="pill-btn" data-axis="y" data-scale="linear">Linear</button>
            <button class="pill-btn active" data-axis="y" data-scale="logarithmic">Log</button>
          </div>
        </div>

        <div class="scale-group" style="gap: 1rem;">
          <label style="display: flex; align-items: center; gap: 0.4rem; cursor: pointer; font-size: 0.875rem; color: var(--gray); font-weight: 500;">
            <input type="checkbox" id="show-trend" checked> Trend
          </label>
          <label style="display: flex; align-items: center; gap: 0.4rem; cursor: pointer; font-size: 0.875rem; color: var(--gray); font-weight: 500;">
            <input type="checkbox" id="show-1sigma" checked> &plusmn;1&sigma;
          </label>
          <label style="display: flex; align-items: center; gap: 0.4rem; cursor: pointer; font-size: 0.875rem; color: var(--gray); font-weight: 500;">
            <input type="checkbox" id="show-2sigma" checked> &plusmn;2&sigma;
          </label>
        </div>
      </div>

      <!-- Main Chart -->
      <div class="chart-container" style="height: 520px;">
        <canvas id="history-chart" aria-label="Bitcoin historical price chart with power law trend" role="img"></canvas>
      </div>

      <!-- Stats beneath chart -->
      <div class="stats-row" id="stats-row">
        <div class="stat-item">
          <div class="stat-label">Latest Price</div>
          <div class="stat-value" id="stat-latest">--</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">All-Time High</div>
          <div class="stat-value" id="stat-ath">--</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">ATH Date</div>
          <div class="stat-value" id="stat-ath-date" style="font-size: 0.95rem;">--</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">All-Time Low</div>
          <div class="stat-value" id="stat-atl">--</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">ATL Date</div>
          <div class="stat-value" id="stat-atl-date" style="font-size: 0.95rem;">--</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Data Points</div>
          <div class="stat-value" id="stat-points">--</div>
        </div>
      </div>

      <!-- Controls -->
      <div class="dashboard" style="margin-top: var(--spacing-lg);">
        <div class="card">
          <div class="card-label">Date Range</div>
          <select id="date-range" style="width: 100%; padding: 0.5rem; font-size: 1rem; border: 1px solid var(--gray-border); border-radius: var(--border-radius);">
            <option value="all">All Time (2010-present)</option>
            <option value="10y">Last 10 Years</option>
            <option value="5y">Last 5 Years</option>
            <option value="3y">Last 3 Years</option>
            <option value="1y">Last Year</option>
          </select>
        </div>

        <div class="card">
          <div class="card-label">Export Data</div>
          <button id="export-csv" class="toggle-btn" style="margin-top: 0.5rem;">Download CSV</button>
        </div>
      </div>

      <!-- How to read the chart -->
      <div class="info-box" style="margin-top: var(--spacing-xl);">
        <h4>How to read this chart</h4>
        <p><strong>Linear + Linear</strong> shows the explosive recent growth in raw dollar terms &mdash; early years are flattened near zero.<br>
           <strong>Linear + Log (price)</strong> spreads out the early history so you can see every cycle clearly.<br>
           <strong>Log + Log</strong> is the classic power-law view: if BTC follows a power law, the trend becomes a straight line.<br>
           <strong>Log time + Linear price</strong> compresses the early quiet years while keeping dollar moves intuitive.</p>
        <p style="margin-top: var(--spacing-sm);"><strong>Trend</strong> is the power-law fair-value curve. The <strong>&sigma; bands</strong> show one and two standard deviations above and below &mdash; historically price has always reverted back inside these bounds.</p>
      </div>

      <!-- Mean Reversion Explanation -->
      <div class="info-box" style="margin-top: var(--spacing-lg);">
        <h4>Understanding Mean Reversion</h4>
        <p>Think of the power law trend as a rubber band. Price can stretch far above or below the trend, but it always snaps back. This isn't magic; it's statistics. Extreme deviations are unsustainable by definition.</p>
      </div>

      <!-- Price Distribution Section -->
      <section id="bell-curve-section" style="margin-top: var(--spacing-xxl);">
        <h2>Price Distribution: How Often Is Bitcoin This Cheap?</h2>
        <p style="color: var(--gray); margin-bottom: var(--spacing-lg);">Based on <strong>5,674 daily closes</strong> since July 2010. Each bar shows how many days per year Bitcoin typically trades at that multiplier of the power law trend. Today's position uses the live price. Inspired by <a href="https://x.com/therealplanc" style="color: var(--orange);">PlanC's quantile analysis</a>.</p>

        <div class="chart-container" style="height: 400px;">
          <canvas id="bell-curve-chart" aria-label="Distribution chart showing how much time Bitcoin has spent at each price level relative to the power law trend" role="img"></canvas>
        </div>

        <!-- Distribution Stats -->
        <div class="dashboard" style="margin-top: var(--spacing-lg);">
          <div class="card">
            <div class="card-label">Today vs Trend</div>
            <div class="card-value" id="today-pct-from-trend" style="font-size: 1.5rem;">--</div>
            <div class="card-sub" id="today-valuation-label">--</div>
          </div>

          <div class="card">
            <div class="card-label">Historical Percentile</div>
            <div class="card-value" id="today-percentile-value" style="font-size: 1.5rem;">--</div>
            <div class="card-sub">Cheaper than <span id="pct-cheaper">--</span>% of all history</div>
          </div>

          <div class="card">
            <div class="card-label">Typical Range (&plusmn;1&sigma;)</div>
            <div class="card-value" id="typical-range-pct" style="font-size: 1.3rem;">--</div>
            <div class="card-sub">Price spends most time in this band</div>
          </div>
        </div>

        <!-- Educational Text -->
        <div class="info-box" style="margin-top: var(--spacing-lg);">
          <h4>Reading This Chart</h4>
          <p>Each bar shows how much of Bitcoin's history was spent at that price level relative to the power law trend. The <strong style="color: #00C853;">green zone</strong> on the left marks periods when Bitcoin was significantly cheaper than trend &mdash; historically great buying opportunities. The <strong style="color: #FF1744;">red zone</strong> on the right marks periods when Bitcoin was significantly more expensive than trend &mdash; prices always came back down from these levels. The orange line shows where we are today.</p>
        </div>
      </section>

      <!-- Weekly Historical Table -->
      <section class="weekly-table-section" id="weekly-history-section">
        <h2>Weekly Historical Data</h2>
        <p style="color: var(--gray); margin-bottom: var(--spacing-md);">
          Your primary sanity check: see every week's closing price, trend value, and deviation.
          Use this to judge current position in historical context.
        </p>

        <!-- Log Deviation Explainer -->
        <div class="info-box" style="margin-bottom: var(--spacing-lg);">
          <h4>Understanding Log Deviation</h4>
          <p style="margin-bottom: var(--spacing-sm);">
            <strong>Log deviation = log₁₀(price ÷ trend)</strong>. It measures distance from fair value on a logarithmic scale,
            which better captures Bitcoin's exponential nature.
          </p>
          <table style="width: 100%; font-size: 0.875rem; margin-top: var(--spacing-sm);">
            <thead>
              <tr>
                <th style="text-align: left; padding: 6px;">Log Dev</th>
                <th style="text-align: left; padding: 6px;">Meaning</th>
                <th style="text-align: left; padding: 6px;">Multiple</th>
                <th style="text-align: left; padding: 6px;">Action Signal</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 6px; color: var(--green); font-weight: 600;">−0.30</td>
                <td style="padding: 6px;">50% below trend</td>
                <td style="padding: 6px;">0.50×</td>
                <td style="padding: 6px;"><span class="log-dev-label extreme-under">Borrow fiat / Strong buy</span></td>
              </tr>
              <tr>
                <td style="padding: 6px; color: var(--green);">−0.15</td>
                <td style="padding: 6px;">~30% below trend</td>
                <td style="padding: 6px;">0.71×</td>
                <td style="padding: 6px;"><span class="log-dev-label under">Accumulate</span></td>
              </tr>
              <tr>
                <td style="padding: 6px; color: var(--gray);">0.00</td>
                <td style="padding: 6px;">Fair value (on trend)</td>
                <td style="padding: 6px;">1.00×</td>
                <td style="padding: 6px;"><span class="log-dev-label fair">Hold</span></td>
              </tr>
              <tr>
                <td style="padding: 6px; color: var(--red);">+0.30</td>
                <td style="padding: 6px;">~100% above trend</td>
                <td style="padding: 6px;">2.00×</td>
                <td style="padding: 6px;"><span class="log-dev-label over">Take profits</span></td>
              </tr>
              <tr>
                <td style="padding: 6px; color: var(--red); font-weight: 600;">+0.60</td>
                <td style="padding: 6px;">~300% above trend</td>
                <td style="padding: 6px;">4.00×</td>
                <td style="padding: 6px;"><span class="log-dev-label extreme-over">Sell / Bubble zone</span></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Table container (populated by weekly-table.js) -->
        <div id="weekly-table-container">
          <p style="color: var(--gray);">Loading weekly data...</p>
        </div>
      </section>

      <!-- Historical Examples -->
      <h2 style="margin-top: var(--spacing-xl);">Notable Deviations</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Event</th>
              <th>Date</th>
              <th>Peak Multiplier</th>
              <th>Subsequent Drawdown</th>
              <th>Time to Trend</th>
            </tr>
          </thead>
          <tbody id="deviations-table">
            <tr>
              <td>2011 Bubble</td>
              <td>Jun 2011</td>
              <td>~8&times; over trend</td>
              <td>-94%</td>
              <td>~2 years</td>
            </tr>
            <tr>
              <td>2013 Double Top</td>
              <td>Dec 2013</td>
              <td>~4&times; over trend</td>
              <td>-86%</td>
              <td>~3 years</td>
            </tr>
            <tr>
              <td>2017 Bull Run</td>
              <td>Dec 2017</td>
              <td>~4&times; over trend</td>
              <td>-84%</td>
              <td>~3 years</td>
            </tr>
            <tr>
              <td>2021 Peak</td>
              <td>Nov 2021</td>
              <td>~2.5&times; over trend</td>
              <td>-77%</td>
              <td>~2 years</td>
            </tr>
            <tr>
              <td>2022 Bottom</td>
              <td>Nov 2022</td>
              <td>~0.5&times; (under)</td>
              <td>N/A (bottom)</td>
              <td>Recovery began</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Rubber Band Animation -->
      <div class="info-box" style="margin-top: var(--spacing-xl); text-align: center;">
        <h4>The Rubber Band Effect</h4>
        <div id="rubber-band-demo" style="height: 100px; position: relative; margin: var(--spacing-lg) 0;">
          <div style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: var(--orange);"></div>
          <div id="rubber-band-ball" style="position: absolute; top: 50%; left: 50%; width: 20px; height: 20px; background: var(--black); border-radius: 50%; transform: translate(-50%, -50%); transition: top 0.5s ease-in-out;"></div>
        </div>
        <p style="margin-top: var(--spacing-sm);">Price stretches away from trend, then gravity pulls it back. Every cycle. Without fail (so far).</p>
        <button id="animate-rubber-band" class="toggle-btn" style="margin-top: var(--spacing-sm);">Animate</button>
      </div>

      <!-- Statistics -->
      <h2 style="margin-top: var(--spacing-xl);">Model Statistics</h2>
      <div class="dashboard">
        <div class="card">
          <div class="card-label">Current &sigma;</div>
          <div class="card-value" id="current-sigma">--</div>
          <div class="card-sub">Log volatility from residuals</div>
        </div>

        <div class="card">
          <div class="card-label">Max Historical Multiplier</div>
          <div class="card-value" id="max-mult">--</div>
          <div class="card-sub" id="max-mult-date">--</div>
        </div>

        <div class="card">
          <div class="card-label">Min Historical Multiplier</div>
          <div class="card-value" id="min-mult">--</div>
          <div class="card-sub" id="min-mult-date">--</div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>Data Sources</h4>
          <p>Historical: Bitstamp, CryptoDataDownload<br>Combined dataset from July 2010</p>
        </div>
        <div class="footer-section">
          <h4>Model</h4>
          <p>Santostasi/Perrenod Power Law Theory<br>Parameters from <a href="https://bitcoinpower.law" style="color: var(--orange);">bitcoinpower.law</a></p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>This is not financial advice. Historical model fit does not guarantee future performance.</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="../js/powerlaw.js"></script>
  <script src="../js/history.js"></script>
  <script src="../js/weekly-table.js"></script>
</body>
</html>
