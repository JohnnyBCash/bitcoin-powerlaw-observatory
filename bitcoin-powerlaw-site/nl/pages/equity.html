<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hypotheek Rekentool - Bitcoin Machtswet Observatorium</title>
  <meta name="description" content="Verken de mogelijkheid om met een overwaardekrediet Bitcoin te kopen. Bekijk verwachte rendementen onder verschillende machtswetscenario's.">
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="header">
    <div class="container">
      <a href="../index.html" class="logo">
        <span class="logo-icon">&#x20BF;</span>
        Machtswet Observatorium
      </a>
      <nav class="nav" aria-label="Hoofdnavigatie">
        <a href="../index.html">Dashboard</a>
        <a href="history.html">Geschiedenis</a>
        <a href="future.html">Toekomst</a>
        <a href="dca.html">DCA</a>
        <a href="equity.html" class="active">Hypotheek</a>
        <a href="balance-sheet.html">Balans</a>
        <a href="retirement.html">Pensioen</a>
        <a href="about.html">Over</a>
      </nav>
      <div class="lang-toggle">
        <a href="../../pages/equity.html" class="lang-link">EN</a>
        <span class="lang-sep">|</span>
        <a href="equity.html" class="lang-link active">NL</a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero">
        <h1>Hypotheek Bitcoin Rekentool</h1>
        <p>Wat als je een overwaardekrediet gebruikt om Bitcoin te kopen? Verken de verwachte uitkomst onder verschillende machtswetscenario's. Zie wanneer je Bitcoin de leenkosten kan overtreffen.</p>
      </section>

      <div class="disclaimer">
        <p><strong>Belangrijk:</strong> Dit is een educatief hulpmiddel gebaseerd op machtswetmodellen, geen financieel advies. Het gebruik van overwaarde om Bitcoin te kopen brengt aanzienlijke risico's met zich mee. Het model gaat ervan uit dat de machtswet blijft gelden. Werkelijke resultaten kunnen afwijken. Doe altijd je eigen onderzoek en raadpleeg een financieel adviseur.</p>
      </div>

      <!-- ── Invoersectie ──────────────────────────────── -->
      <div class="card" id="eq-input-section">

        <!-- Leningparameters -->
        <h3>Leningparameters</h3>
        <div class="input-grid">
          <div class="input-group">
            <label for="eq-loan-amount">Leenbedrag (<span id="eq-currency-label">&euro;</span>)</label>
            <input type="number" id="eq-loan-amount" value="100000" min="1000" step="1000">
          </div>
          <div class="input-group">
            <label for="eq-currency">Valuta</label>
            <select id="eq-currency">
              <option value="USD">$ USD</option>
              <option value="EUR" selected>&euro; EUR</option>
            </select>
          </div>
          <div class="input-group">
            <label for="eq-duration">Looptijd (jaren)</label>
            <input type="number" id="eq-duration" value="15" min="1" max="30">
          </div>
          <div class="input-group">
            <label for="eq-interest-rate">Rente</label>
            <input type="range" id="eq-interest-rate" min="3" max="6" step="0.1" value="4.5">
            <div class="slider-value"><span id="eq-interest-value">4.5</span>%</div>
          </div>
        </div>

        <!-- Aflossingsvrij toggle -->
        <div class="toggle-switch-row" style="margin-top: var(--spacing-sm);">
          <label class="toggle-switch">
            <input type="checkbox" id="eq-interest-only">
            <span class="toggle-slider"></span>
          </label>
          <span class="toggle-label" id="eq-interest-only-label">Aflossingsvrij: UIT</span>
        </div>

        <p class="rate-note" style="font-size: 0.8125rem; color: var(--gray); margin-top: var(--spacing-xs);">Let op: deze rekentool gaat uit van een vaste rente voor de gehele looptijd. Bij variabele rente kunnen de werkelijke kosten aanzienlijk afwijken.</p>

        <!-- Woning & Hypotheek -->
        <div class="loans-toggle-section">
          <h3>Woning &amp; Hypotheek</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="eq-home-value">Woningwaarde (<span id="eq-currency-label2">&euro;</span>)</label>
              <input type="number" id="eq-home-value" value="400000" min="0" step="10000">
            </div>
            <div class="input-group">
              <label for="eq-mortgage-balance">Huidig hypotheeksaldo (<span id="eq-currency-label3">&euro;</span>)</label>
              <input type="number" id="eq-mortgage-balance" value="200000" min="0" step="10000">
            </div>
            <div class="input-group">
              <label for="eq-mortgage-rate">Hypotheekrente</label>
              <input type="range" id="eq-mortgage-rate" min="1" max="6" step="0.1" value="3.5">
              <div class="slider-value"><span id="eq-mortgage-rate-value">3.5</span>%</div>
            </div>
          </div>

          <!-- Auto-berekende overwaarde -->
          <div class="loan-params" style="margin-top: var(--spacing-md); display: flex; gap: var(--spacing-xl); flex-wrap: wrap;">
            <div>
              <div class="equity-label">Overwaarde</div>
              <div class="equity-value" id="eq-home-equity">--</div>
            </div>
            <div>
              <div class="equity-label">Bestaand LTV</div>
              <div class="equity-value" id="eq-existing-ltv">--</div>
            </div>
            <div>
              <div class="equity-label">Totaal LTV (met nieuwe lening)</div>
              <div class="equity-value" id="eq-total-ltv">--</div>
            </div>
          </div>
          <div id="eq-ltv-warning" class="hidden" style="color: var(--red); font-size: 0.875rem; font-weight: 500; margin-top: var(--spacing-xs);">
            &#9888; Totaal LTV overschrijdt 80%. Geldverstrekkers vereisen doorgaans een hypotheekverzekering of kunnen de lening afwijzen.
          </div>
        </div>

        <!-- Bitcoin Aankoop -->
        <div class="loans-toggle-section">
          <h3>Bitcoin Aankoop</h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="eq-buy-timing">Wanneer kopen</label>
              <select id="eq-buy-timing">
                <option value="now" selected>Nu kopen tegen huidige prijs</option>
                <option value="future">Toekomstige aankoop (schatting)</option>
              </select>
            </div>
            <div class="input-group">
              <label>Huidige BTC-prijs</label>
              <div id="eq-live-price" style="font-size: 1.1rem; font-weight: 600; padding-top: 0.3rem;"><span class="price-loading"></span></div>
            </div>
          </div>

          <!-- Toekomstige datumkiezer (standaard verborgen) -->
          <div id="eq-future-date-section" class="hidden" style="margin-top: var(--spacing-md);">
            <div class="input-grid">
              <div class="input-group">
                <label for="eq-future-year">Aankoopjaar</label>
                <input type="number" id="eq-future-year" value="2026" min="2025" max="2040">
              </div>
              <div class="input-group">
                <label for="eq-future-month">Aankoopmaand</label>
                <select id="eq-future-month">
                  <option value="1">Januari</option>
                  <option value="2">Februari</option>
                  <option value="3">Maart</option>
                  <option value="4">April</option>
                  <option value="5">Mei</option>
                  <option value="6" selected>Juni</option>
                  <option value="7">Juli</option>
                  <option value="8">Augustus</option>
                  <option value="9">September</option>
                  <option value="10">Oktober</option>
                  <option value="11">November</option>
                  <option value="12">December</option>
                </select>
              </div>
              <div class="input-group">
                <label>Verwachte BTC-prijs</label>
                <div id="eq-future-price" style="font-size: 1.1rem; font-weight: 600; padding-top: 0.3rem;">--</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Scenario -->
        <div class="loans-toggle-section">
          <h3>Prijsscenario <span class="scenario-info" title="Scenario's modelleren verschillende paden die de Bitcoin-prijs kan volgen op basis van de machtswettrend.">?</span></h3>
          <div class="input-grid">
            <div class="input-group">
              <label for="eq-scenario">Scenario</label>
              <select id="eq-scenario">
                <option value="cyclical" selected>Cyclisch (&plusmn;1&sigma;, verlengde periodes)</option>
                <option value="cyclical_bear">Bear Bias Cycli (60% onder trend)</option>
                <option value="smooth_trend">Vloeiende Trend (blijft op trend)</option>
                <option value="smooth_bear">Bear (vlak &minus;1&sigma; onder trend)</option>
                <option value="smooth_deep_bear">Diepe Bear (vlak &minus;2&sigma; onder trend)</option>
              </select>
            </div>
          </div>
          <div class="scenario-descriptions" style="font-size: 0.8125rem; color: var(--gray); margin-top: var(--spacing-xs);">
            <div id="eq-scenario-desc">Hausse-baisse cycli rond de machtswettrend met geleidelijk langere periodes &mdash; het meest realistische historische patroon.</div>
          </div>
        </div>

        <button class="calculate-btn" id="eq-calculate-btn">Hypotheek Plan Berekenen</button>
        <button class="calculate-btn secondary" id="eq-compare-btn">Vergelijk Alle Scenario's</button>

        <!-- Actieknoppen — getoond na eerste berekening -->
        <div class="action-buttons hidden" id="eq-action-buttons">
          <button class="calculate-btn secondary" id="eq-export-pdf-btn">&#128196; Opslaan als PDF</button>
          <button class="calculate-btn secondary" id="eq-reset-btn">&#8634; Standaardwaarden</button>
        </div>

        <!-- Statusbanner -->
        <div id="eq-status-banner" class="status-banner hidden">
          <div class="status-icon" id="eq-status-icon"></div>
          <div class="status-content">
            <div class="status-headline" id="eq-status-headline"></div>
            <div class="status-detail" id="eq-status-detail"></div>
          </div>
        </div>
      </div>

      <!-- ── Samenvattingskaarten ──────────────────────────────── -->
      <section id="eq-results-section" class="hidden">
        <h2>Samenvatting Hypotheeklening</h2>
        <div class="dashboard" id="eq-summary-cards">
          <!-- Gevuld door JS -->
        </div>
      </section>

      <!-- ── Waardegrafiek ────────────────────────────────── -->
      <section id="eq-chart-section" class="hidden">
        <h2>Bitcoin Waarde vs Leenkosten</h2>
        <p>De groene lijn is de verwachte waarde van je Bitcoin. De oranje lijn zijn de cumulatieve leenkosten. Waar groen boven oranje uitstijgt is je break-evenpunt.</p>
        <div class="chart-container" style="position: relative; height: 420px;">
          <canvas id="eq-value-chart" aria-label="Bitcoin waarde versus leenkosten over tijd"></canvas>
        </div>
      </section>

      <!-- ── Jaarlijks overzicht ─────────────────────────── -->
      <section id="eq-table-section" class="hidden">
        <h2>Jaarlijks Overzicht</h2>
        <div class="table-container">
          <div class="weekly-table-wrapper" style="max-height: 500px;">
            <table>
              <thead>
                <tr>
                  <th>Jaar</th>
                  <th>BTC-prijs</th>
                  <th>BTC-waarde</th>
                  <th>Jaarkosten</th>
                  <th>Cumulatieve Kosten</th>
                  <th>Leningsaldo</th>
                  <th>Nettopositie</th>
                  <th>LTV</th>
                  <th>ROI</th>
                </tr>
              </thead>
              <tbody id="eq-yearly-table-body"></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- ── Scenariovergelijking ────────────────────────── -->
      <section id="eq-comparison-section" class="hidden">
        <h2>Scenariovergelijking</h2>
        <p>Hoe het overwaardekrediet presteert onder elk prijsscenario.</p>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Scenario</th>
                <th>Eindwaarde BTC</th>
                <th>Totale Kosten</th>
                <th>Netto Winst/Verlies</th>
                <th>ROI</th>
                <th>Break-even</th>
              </tr>
            </thead>
            <tbody id="eq-comparison-body"></tbody>
          </table>
        </div>
      </section>

      <!-- ── Inzicht ────────────────────────────────────── -->
      <section id="eq-insight-section" class="hidden">
        <div class="info-box">
          <h4>Belangrijk Inzicht</h4>
          <p id="eq-insight-text"></p>
        </div>
      </section>

      <!-- ── Kruisverwijzingen ────────────────────────────── -->
      <section class="cross-links">
        <h3>Ontdek Meer Tools</h3>
        <div class="cross-links-grid">
          <a href="dca.html" class="cross-link-card">
            <strong>DCA Rekentool</strong>
            <span>Simuleer geleidelijk investeren in Bitcoin over tijd</span>
          </a>
          <a href="retirement.html" class="cross-link-card">
            <strong>Pensioen Rekentool</strong>
            <span>Plan je Bitcoin-ondersteunde pensioenopname</span>
          </a>
          <a href="balance-sheet.html" class="cross-link-card">
            <strong>Balans Rekentool</strong>
            <span>Model bedrijfsmatige Bitcoin-allocatie</span>
          </a>
          <a href="future.html" class="cross-link-card">
            <strong>Toekomstprojecties</strong>
            <span>Verken machtswet prijsprojecties en mijlpalen</span>
          </a>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <details class="footer-section methodology-accordion">
          <summary><h4 style="display: inline; cursor: pointer;">Methodologie</h4></summary>
          <p>Machtswet trend: verwacht groeipad. Scenario-engine modelleert cyclische afwijking rond trend. Leningaflossing volgt standaard annuïtair of aflossingsvrij schema.</p>
        </details>
        <div class="footer-section">
          <h4>Disclaimer</h4>
          <p>Geen financieel advies. Alleen voor educatieve doeleinden.</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>Dit is geen financieel advies. Het gebruik van overwaarde om in Bitcoin te investeren brengt aanzienlijke risico's met zich mee. Historische modelfit garandeert geen toekomstige prestaties.</p>
      </div>
    </div>
  </footer>

  <!-- Pagina-specifieke stijlen -->
  <style>
    .chart-container canvas {
      width: 100% !important;
      height: 100% !important;
    }

    section {
      position: relative;
      z-index: 1;
      margin-bottom: var(--spacing-xl);
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--spacing-md);
      margin: var(--spacing-lg) 0;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-xs);
    }

    .input-group label {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--gray);
    }

    .input-group input[type="number"],
    .input-group select {
      padding: var(--spacing-xs) var(--spacing-sm);
      border: 1px solid var(--gray-border);
      border-radius: var(--border-radius);
      font-family: var(--font-family);
      font-size: 1rem;
      background: var(--white);
    }

    .input-group input:focus,
    .input-group select:focus {
      outline: none;
      border-color: var(--orange);
    }

    .slider-value {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--orange);
      text-align: center;
    }

    .loans-toggle-section {
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing-lg);
      border-top: 1px solid var(--gray-border);
    }

    .toggle-switch-row {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      margin: var(--spacing-md) 0;
    }

    .toggle-switch {
      position: relative;
      width: 52px;
      height: 28px;
      flex-shrink: 0;
    }

    .toggle-switch input { display: none; }

    .toggle-slider {
      position: absolute;
      inset: 0;
      background: var(--gray-border);
      border-radius: 28px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .toggle-slider::before {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      left: 3px;
      top: 3px;
      background: var(--white);
      border-radius: 50%;
      transition: transform 0.3s;
    }

    .toggle-switch input:checked + .toggle-slider {
      background: var(--orange);
    }

    .toggle-switch input:checked + .toggle-slider::before {
      transform: translateX(24px);
    }

    .toggle-label {
      font-weight: 500;
      font-size: 0.9375rem;
    }

    .loan-params {
      padding: var(--spacing-md);
      background: var(--gray-light);
      border-radius: var(--border-radius);
    }

    .equity-label {
      font-size: 0.75rem;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .equity-value {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .hidden { display: none; }

    .calculate-btn {
      display: inline-block;
      padding: var(--spacing-sm) var(--spacing-xl);
      border: none;
      border-radius: var(--border-radius);
      font-family: var(--font-family);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: var(--spacing-md);
      margin-right: var(--spacing-sm);
    }

    .calculate-btn:not(.secondary) {
      background: var(--orange);
      color: var(--white);
    }

    .calculate-btn:not(.secondary):hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .calculate-btn.secondary {
      background: var(--white);
      color: var(--black);
      border: 1px solid var(--gray-border);
    }

    .calculate-btn.secondary:hover {
      border-color: var(--orange);
      color: var(--orange);
    }

    .action-buttons {
      display: flex;
      gap: var(--spacing-sm);
      margin-top: var(--spacing-md);
      flex-wrap: wrap;
    }

    /* Statusbanner */
    .status-banner {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-md);
      padding: var(--spacing-md) var(--spacing-lg);
      border-radius: var(--border-radius);
      margin-top: var(--spacing-lg);
      border-left: 4px solid;
      animation: statusFadeIn 0.3s ease-out;
    }

    @keyframes statusFadeIn {
      from { opacity: 0; transform: translateY(-8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .status-banner.status-green {
      background: rgba(0, 200, 83, 0.08);
      border-left-color: var(--green);
    }

    .status-banner.status-amber {
      background: rgba(247, 147, 26, 0.08);
      border-left-color: var(--orange);
    }

    .status-banner.status-red {
      background: rgba(255, 23, 68, 0.08);
      border-left-color: var(--red);
    }

    .status-icon {
      font-size: 2rem;
      line-height: 1;
      flex-shrink: 0;
    }

    .status-content {
      flex: 1;
      min-width: 0;
    }

    .status-headline {
      font-size: 1.125rem;
      font-weight: 600;
      color: var(--black);
      margin-bottom: var(--spacing-xs);
    }

    .status-detail {
      font-size: 0.9375rem;
      color: var(--gray);
      line-height: 1.5;
    }

    .status-detail strong {
      color: var(--black);
    }

    .roi-positive { color: var(--green); font-weight: 600; }
    .roi-negative { color: var(--red); font-weight: 600; }

    .comparison-winner {
      background: rgba(0, 200, 83, 0.08);
      font-weight: 600;
    }

    /* Laadanimatie voor BTC-prijs */
    .price-loading {
      display: inline-block;
      width: 100px;
      height: 1.1rem;
      background: linear-gradient(90deg, var(--gray-light) 25%, #e8e8e8 50%, var(--gray-light) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 4px;
      vertical-align: middle;
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* Scenario info badge */
    .scenario-info {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--gray-light);
      color: var(--gray);
      font-size: 0.75rem;
      font-weight: 600;
      cursor: help;
      vertical-align: middle;
      margin-left: var(--spacing-xs);
    }

    /* Kruisverwijzingen sectie */
    .cross-links {
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing-lg);
      border-top: 1px solid var(--gray-border);
    }

    .cross-links h3 {
      text-align: center;
      margin-bottom: var(--spacing-lg);
    }

    .cross-links-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: var(--spacing-md);
    }

    .cross-link-card {
      display: block;
      padding: var(--spacing-md);
      border: 1px solid var(--gray-border);
      border-radius: var(--border-radius);
      color: var(--black);
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .cross-link-card:hover {
      border-color: var(--orange);
      box-shadow: 0 2px 8px rgba(247, 147, 26, 0.1);
      opacity: 1;
    }

    .cross-link-card strong {
      display: block;
      margin-bottom: 4px;
      font-size: 0.9375rem;
    }

    .cross-link-card span {
      font-size: 0.8125rem;
      color: var(--gray);
    }

    /* Methodologie accordion */
    .methodology-accordion summary {
      list-style: none;
      cursor: pointer;
    }
    .methodology-accordion summary::-webkit-details-marker {
      display: none;
    }
    .methodology-accordion summary h4::after {
      content: ' +';
      font-weight: 400;
      color: var(--gray);
    }
    .methodology-accordion[open] summary h4::after {
      content: ' \2212';
    }
    .methodology-accordion p {
      margin-top: var(--spacing-xs);
    }

    /* Invoervalidatie */
    .validation-msg {
      font-size: 0.8125rem;
      color: var(--red);
      margin-top: 2px;
      display: none;
    }
    .validation-msg.visible {
      display: block;
    }

    /* Mobiel-responsieve tabellen met vaste eerste kolom */
    @media (max-width: 768px) {
      .table-container {
        position: relative;
      }
      .table-container table {
        min-width: 700px;
      }
      .table-container th:first-child,
      .table-container td:first-child {
        position: sticky;
        left: 0;
        background: var(--white);
        z-index: 2;
        box-shadow: 2px 0 4px rgba(0,0,0,0.06);
      }
      .table-container thead th:first-child {
        z-index: 3;
      }
      .table-container tr:hover td:first-child {
        background: var(--gray-light);
      }
    }

    @media print {
      .header, .footer, .nav, .hero, .disclaimer,
      .calculate-btn, .action-buttons,
      #eq-input-section { display: none !important; }
      .hidden { display: block !important; }
      body { background: white; }
      .container { max-width: 100%; padding: 0; }
      section { page-break-inside: avoid; margin-bottom: 1rem; }
      .chart-container { height: 300px !important; }
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.2/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="../../js/powerlaw.js"></script>
  <script src="../../js/retirement.js"></script>
  <script src="../../js/equity.js"></script>
  <script src="../js/equity-ui.js"></script>
</body>
</html>
